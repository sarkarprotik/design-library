!function(e,t,s){class i extends S4SInputBase{constructor(){super(),this.data={},this.lastFilteredValue="",this.selectedListItem=null}connectedCallback(){this.init(s.templates.comboBox),this.prepare(),this.createTooltip(),this.addFocusAndBlurEvents(this.elements.input),this.getData(),this.bindEvents()}getData(){this.httpRequest(`/assets/data/cepdata_${this.market}.json`,{},e=>{e.json().then(e=>this.data=e)})}bindEvents(){this.elements.input.addEventListener("keydown",e=>{if([this.keyCodes.ARROW_DOWN].indexOf(e.keyCode)>-1)this.selectedListItem=this.selectedListItem?this.selectedListItem.nextElementSibling:this.elements.listbox.children[0],this.markListItem();else if([this.keyCodes.ARROW_UP].indexOf(e.keyCode)>-1)this.selectedListItem=this.selectedListItem?this.selectedListItem.previousElementSibling:this.elements.listbox.children[this.elements.listbox.children.length-1],this.markListItem();else if([this.keyCodes.ENTER,this.keyCodes.TAB].indexOf(e.keyCode)>-1)return e.stopPropagation(),this.selectListItem(),void this.hideItems()}),this.elements.input.addEventListener("keyup",e=>{e.preventDefault();const t=e.target.value.trim();this.lastFilteredValue!==t&&(this.filter(t),this.selectedListItem=this.elements.listbox.children[0],this.markListItem()),this.lastFilteredValue=t});let e=null;const t=this;this.elements.input.addEventListener("blur",s=>{clearTimeout(e),e=setTimeout(()=>{t.elements.listbox.setAttribute("hidden",!0)},200)}),this.elements.listbox.addEventListener("click",e=>{e.preventDefault(),this.selectedListItem=this.getParentElement(e.target,"li"),this.selectListItem(),this.hideItems()})}hideItems(){this.elements.listbox.innerHTML="",this.elements.listbox.setAttribute("hidden",!0),this.lastFilteredValue="",this.selectedListItem=null}selectListItem(){this.selectedListItem&&(this.json=this.selectedListItem.data,this.elements.input.value=this.selectedListItemText)}markListItem(){if(this.selectedListItem){const e=this.selectedListItem.previousElementSibling;e&&e.classList.remove("key-active");const t=this.selectedListItem.nextElementSibling;t&&t.classList.remove("key-active"),this.selectedListItem.classList.add("key-active"),this.selectedListItem.scrollIntoView({behavior:"smooth",block:"center"})}}filter(e){if(e.length<2)return void this.hideItems();const t=[],s=this.data.countries;for(let i=0;i<s.length;i++){const n=s[i],l=n.name.toLowerCase().indexOf(e.toLowerCase())>-1;for(let s=0;s<n.cities.length;s++){const i=n.cities[s],a=l||i.name.toLowerCase().indexOf(e.toLowerCase())>-1;for(let s=0;s<i.airports.length;s++){const o=i.airports[s];(l||a||o.name.toLowerCase().indexOf(e.toLowerCase())>-1)&&t.push({country:n.name,city:i.name,airport:{code:o.code,name:o.name}})}}}this.addFilteredItems(t),this.elements.listbox.removeAttribute("hidden")}addFilteredItems(e){this.elements.listbox.innerHTML="";for(let t=0;t<e.length;t++){const i=this.appendTemplate(s.templates.comboBoxListItem,this.elements.listbox);this.setElements(i),i.data=e[t],i.elements.country.innerText=i.data.country,i.elements.cityAirport.innerText=`${i.data.city} - ${i.data.airport.name}`,i.elements.airportCode.innerText=i.data.airport.code}}static get observedAttributes(){return["options"]}attributeChangedCallback(){}get market(){return this.getAttribute("market")||"se-sv"}get selectedListItemText(){return`${this.selectedListItem.data.city} ${this.selectedListItem.data.airport.code}`}}e.customElements.define("s4s-combobox",i)}(window,document,window.s4s);