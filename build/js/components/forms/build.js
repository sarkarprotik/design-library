"use strict";window.flysasLibrary=window.flysasLibrary||{},flysasLibrary.forms=flysasLibrary.forms||function(k){function A(e,t){if(e){if(e.classList.contains(t))return e;for(;e.parentElement;)if((e=e.parentElement).classList&&e.classList.contains(t))return e}}function t(c,C){var d;function f(t){var l,o,u,c=t.querySelector("input"),d=t.querySelector(".input-listbox"),a=(A(c,"col-form-field"),A(c,"sas-input")),e=d.getAttribute("data-items-source"),f=e&&flysasLibrary.pageData&&flysasLibrary.pageData[e]||[],i=d.getAttribute("data-preselect"),v=0,m="chosen";function y(){v=0;var e=(u||{}).dataItem;e?(c.value=e.value2||e.value1,c.setAttribute("aria-activedescendant",""),C&&C(c,e),a&&a.classList.add("focused")):a&&a.classList.remove("focused"),p(!1)}function g(){if(!l||0===l.length)return v=0,void c.setAttribute("aria-activedescendant","");v<0?v=l.length-1:v>=l.length&&(v=0);for(var e=0;e<l.length;e++)l[e].classList.remove(m);-1<v&&(l[v].classList.add(m),c.setAttribute("aria-activedescendant",l[v].id),u=l[v])}function p(e){t.setAttribute("aria-expanded",e)}function n(e){if(d&&d.scrollTo&&d.scrollTo(0,0),37===e.keyCode||39===e.keyCode||91===e.keyCode)return!0;if(40===e.keyCode)v++,g();else if(38===e.keyCode)v--,g();else{if(10===e.keyCode||13===e.keyCode||9===e.keyCode)return y(),c.blur(),clearTimeout(h),!1;o=c.value.trim(),function(){for(;d.hasChildNodes();)d.removeChild(d.lastChild);l=void 0,p(!1)}();for(var t=[],a=0;a<f.length;a++){((i=f[a]).value1&&new RegExp(o,"gi").test(i.value1)||i.value2&&new RegExp(o,"gi").test(i.value2))&&t.push(i)}for(a=0;a<t.length;a++){var i=t[a],n=k.createElement("li");if(n.id=d.id+"-item-"+a,n.className="city-listbox-item"+(0===a?" "+m:""),i.value1&&i.value1!==i.value2){var r=k.createElement("span");r.className="value-1",r.insertAdjacentHTML("beforeend",i.value1),n.appendChild(r)}if(i.value2){var s=k.createElement("span");s.className="value-2",s.insertAdjacentHTML("beforeend",i.value2),n.appendChild(s)}n.dataItem=i,d.appendChild(n)}l=d.querySelectorAll("li"),p(0<t.length),0<t.length&&o&&(u=l[0])}}t.setAttribute("aria-expanded",!1),c.addEventListener("keydown",function(e){return 10!==e.keyCode&&13!==e.keyCode||e.preventDefault(),!0}),c.addEventListener("keyup",function(e){9!==e.keyCode&&n(e)});var h=null;if(c.addEventListener("blur",function(e){h=setTimeout(function(){y()},250)}),c.addEventListener("focus",function(e){""!==this.getAttribute("readonly")&&(this.value="",n({keyCode:0}))}),d.addEventListener("click",function(e){clearTimeout(h),u=A(e.target,"city-listbox-item"),y()}),f){if(i)for(var r=0;r<f.length;r++){var s=f[r],b=s.value2||s.value1||"",L=s.value3||"";if(b.replace(/\s/gi,"").toLowerCase()===i.toLowerCase()||L.toLowerCase()===i.toLowerCase()){u={dataItem:s};break}}u=u||{dataItem:f[0]},y()}return{filterData:n}}!function(){if(c&&!d){var t;C=c.callback||C;for(var e=c.querySelectorAll(".col-form-field input, .col-form-field select, .sas-input input, .sas-input select, .sas-input textarea"),a=0;a<e.length;a++){e[a].getAttribute("data-behavior");var i=e[a],n=A(i,"form-field"),r=n&&n.classList.contains("form-combobox"),l=i.hasAttribute("readonly");i.validate=s,i.addEventListener("blur",s),i.addEventListener("focus",function(e){e.stopPropagation();var t=A(this,"sas-input");t.classList.remove("invalid"),u(t,!0)}),r&&(i.listBox=new f(n))}d=0<e.length}function o(e){clearTimeout(t),t=setTimeout(function(){c.classList.toggle("active",e),t=null},100)}function u(e,t){e.querySelector("label");e.classList.toggle("focused",t),o(t)}function s(e){this.value=this.value.trim();var t=this.value||"",a=this.getAttribute("data-validation"),i=A(this,"sas-input"),n=i.querySelector(".message"),r=a&&!new RegExp(a,"gi").test(t),s=""===t&&n&&""!==n.innerText;if(!s&&a&&(s=a&&r),!this.listBox)return""!==t||l?o(!1):u(i,!1),!s||(i.classList.add("invalid"),!1);o(!1)}}()}function e(){for(var e=0;e<k.querySelectorAll("form").length;e++){new t(k.querySelectorAll("form")[e],function(e,t){console.log(e),console.log(t)})}}return e(),{init:e}}((window,document));