"use strict";function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _wrapNativeSuper(t){var n="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(e,t)})(t)}function isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _construct(t,e,n){return(_construct=isNativeReflectConstruct()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var s=new(Function.bind.apply(t,i));return n&&_setPrototypeOf(s,n.prototype),s}).apply(null,arguments)}function _isNativeFunction(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}window.s4s=window.s4s||{},window.s4s.templates=(window,document,{formField:'\n      <label class="form-field" element="formField">\n        <span class="label" element="label"></span>\n      </label>\n      <span class="message" element="message"></span>\n    ',comboBox:'\n      <label id="" role="combobox" aria-expanded="false" aria-owns="" aria-haspopup="listbox" class="form-field" element="formField">\n        <span id="" class="label" element="label"></span>\n        <input id="" type="text" name="" element="input">\n      </label>\n      <span class="message" element="message"></span>\n      <ul id="" aria-labelledby="" role="listbox" element="listbox" hidden></ul>\n    ',comboBoxListItem:'\n      <li>\n        <button element="button" tabindex="-1">\n          <div>\n            <span element="city-airport"></span>\n            <span class="block-item" element="country"></span>\n          </div>\n          <strong element="airport-code"></strong>\n        </button>\n      </li>\n    ',custom:{input:'\n        <label class="form-field" element="formField">\n          <span class="label" element="label"></span>\n          <input id="" type="text" name="" element="input">\n        </label>\n        <div class="form-custom" element="custom" hidden></div>\n      ',pax:'\n        <div element="pax">\n          <div class="pax-type">\n            <span element="adults" data-min="1"></span>\n            <div class="calculator">\n              <button data-type="adults" data-inc="-1" tabindex="-1">-</button>\n              <span element="adults-count">1</span>\n              <button data-type="adults" data-inc="1" tabindex="-1">+</button>\n            </div>\n          </div>\n          <div class="pax-type">\n            <span element="children" data-min="0"></span>\n            <div class="calculator">\n              <button data-type="children" data-inc="-1" tabindex="-1">-</button>\n              <span element="children-count">0</span>\n              <button data-type="children" data-inc="1" tabindex="-1">+</button>\n            </div>\n          </div>\n          <div class="pax-type">\n            <span element="infants" data-min="0"></span>\n            <div class="calculator">\n              <button data-type="infants" data-inc="-1" tabindex="-1">-</button>\n              <span element="infants-count">0</span>\n              <button data-type="infants" data-inc="1" tabindex="-1">+</button>\n            </div>\n          </div>\n        </div>\n      '},datePicker:{input:'\n        <label class="form-field" element="formField">\n          <span class="label" element="label"></span>\n          <input id="" type="text" name="" element="input">\n        </label>\n        <div class="form-calendar" element="calendar" hidden></div>\n      ',tablesWrap:'\n        <div class="table-calendar" element="outbound-wrap">\n          <table element="outbound"></table>\n        </div>\n        <div class="table-calendar" element="inbound-wrap">\n          <table element="inbound"></table>\n        </div>\n      ',table:'\n        <thead>\n          <tr>\n            <th colspan="7" element="type"></th>\n          </tr>\n          <tr>\n            <th><button class="btn-prev" element="prev-month" tabindex="-1"></button></th>\n            <th class="month-header" colspan="5" element="month-name"></th>\n            <th><button class="btn-next" element="next-month" tabindex="-1"></button></th>\n          </tr>\n          <tr>\n            <th>M</th>\n            <th>T</th>\n            <th>O</th>\n            <th>T</th>\n            <th>F</th>\n            <th>L</th>\n            <th>S</th>\n          </tr>\n        </thead>\n        <tbody element="body"></tbody>\n      ',week:'\n        <tr>\n          <td><button tabindex="-1"></button></td>\n          <td><button tabindex="-1"></button></td>\n          <td><button tabindex="-1"></button></td>\n          <td><button tabindex="-1"></button></td>\n          <td><button tabindex="-1"></button></td>\n          <td><button tabindex="-1"></button></td>\n          <td><button tabindex="-1"></button></td>\n        </tr>\n      '},modal:'\n      <div class="flysas modal open" role="dialog" aria-modal="true" element="modal">\n        <div class="modal-content">\n          <h1 class="h2 modal-title" element="heading"></h1>\n          <button type="button" class="btn btn-lg btn-close" data-close="true" aria-label="Close Modal" element="close">\n            <s4s-icon name="in--close"></s4s-icon>\n          </button>\n          <div class="slot-content" element="content"></div>\n        </div>\n      </div>\n    ',card:'\n      <a href="" class="card banner banner-hero" element="card">\n        <div class="sas-image sas-image-fill" element="image-wrap">\n          <img src="" role="presentation" element="image">\n        </div>\n        <div class="content slot-content" element="content">\n          <h1 element="heading"></h1>\n          <h2 element="subheading"></h2>\n          <button class="btn-md" element="button"></button>\n        </div>\n      </a>\n    ',demo:'\n      <form class="sas-form-grid" onsubmit="return false">\n        <fieldset>\n          <legend>Demo test</legend>\n          <s4s-input id="img-src" label="Img src test" element="imgInput"></s4s-input>\n        </fieldset>\n        <fieldset>\n          <button type="submit" element="button">Skicka</button>\n        </fieldset>\n      </form>\n    ',accordion:'\n      <div class="flysas-accordion" element="accordion">\n        <div class="accordion-btn" element="toggler">\n          <button class="btn btn-toggle" aria-expanded="false" element="button">\n            <span element="label"></span>\n            <s4s-icon name="cl--arrow-up"></s4s-icon>\n          </button>\n        </div>\n        <div class="accordion-content slot-content" element="content"><s4s-icon name="cl--arrow-up"></s4s-icon></div>\n      </div>\n    ',toggle:{wrap:'\n        <div class="flysas-toggles toggles">\n          <div class="toggle-btns" element="toggle-buttons"></div>\n        </div>\n      ',button:'\n        <button class="btn btn-md" aria-pressed="true"><span element="button-text"></span></button>\n      '},cep:'\n      <s4s-toggle options=\'[{"id":"oneway","name":"Enkel resa"},{"id":"roundtrip","name":"Tur retur","selected":true}]\'></s4s-toggle>\n      <form class="sas-form-flex" element="form">\n        <s4s-combobox label="Från*" market="se-sv" element="from"></s4s-combobox>\n        <s4s-combobox label="Till*" market="se-sv" element="to"></s4s-combobox>\n        <s4s-datepicker\n          label="Avresedatum*"\n          outbound-label="Avresa"\n          inbound-label="Hemresa"\n          monthNames="Jan,Feb,Mar,Apr,Maj,Juni,Juli,Aug,Sep,Okt,Nov,Dec"\n          date-delimiter="till"\n          market="se-sv"\n          element="datepicker">\n        </s4s-datepicker>\n        <s4s-custom-pax\n          class="focused"\n          label="Resenärer*"\n          adults-label="Vuxna"\n          children-label="Barn (2-11 år)"\n          infants-label="Spädbarn (0-23 månader)"\n          passenger-label="passagerare"\n          market="se-sv"\n          element="pax">\n        </s4s-custom-pax>\n        <button class="btn-lg" element="button">Sök</button>\n      </form>\n    '});var S4SBase=function(){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).elements={},t}return _inherits(e,_wrapNativeSuper(HTMLElement)),_createClass(e,[{key:"init",value:function(t){this.html=this.innerHTML.trim(),this.innerHTML="",this.appendTemplate(t),this.setSlotContent(),this.setElements()}},{key:"appendTemplate",value:function(t,e){var n=e||this;if(t){var i=document.createElement("template");return i.innerHTML=t,n.appendChild(document.importNode(i.content,!0)),n.lastElementChild}return n}},{key:"setSlotContent",value:function(){this.querySelector(".slot-content")&&this.html&&(this.querySelector(".slot-content").innerHTML=this.html)}},{key:"setElements",value:function(t){var e=t||this;e.elements=e.elements||{};for(var n=e.querySelectorAll("[element]"),i=0;i<n.length;i++){var s=n[i],a=s.getAttribute("element").replace(/-([\w]{1})/gi,function(t){return t.replace("-","").toUpperCase()});e.elements[a]=s;var o=e.getAttribute(a)||e.getAttribute(s.getAttribute("element"));if(o)switch(s.tagName){case"IMG":s.src=o;break;default:s.innerText=o}}}},{key:"getParentElement",value:function(t,e){for(;t.parentElement;){if(t.classList.contains(e)||t.tagName===e.toUpperCase())return t;t=t.parentElement}}},{key:"publish",value:function(t,e){window.dispatchEvent(new CustomEvent(t,{detail:e}))}},{key:"subscribe",value:function(t,e){window.addEventListener(t,e)}},{key:"httpRequest",value:function(t,e,n){fetch(t,e).then(n)}}]),e}(),S4SInputBase=function(){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).keyCodes={ESC:27,TAB:9,ENTER:13,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40},t}return _inherits(e,S4SBase),_createClass(e,[{key:"prepare",value:function(){this.connected=!0,this.classList.add("sas-input"),this.querySelector("ul")?this.classList.add("sas-combobox"):this.querySelector(".form-calendar")?this.classList.add("sas-datepicker"):this.querySelector(".form-custom")&&this.classList.add("sas-custom"),this.mandatory&&this.classList.add("mandatory"),this.setAttribute("data-name",this.name)}},{key:"createTooltip",value:function(){if(this.infoText){var t=document.createElement("s4s-icon");t.setAttribute("name","cl--alert-circle"),t.setAttribute("additionalClass","form-field-icon"),t.setAttribute("text",this.infoText),this.elements.formField.appendChild(t);var e=document.createElement("div");e.innerText=this.infoText,e.classList.add("form-tooltip","sas-tooltip","hidden"),t.addEventListener("click",function(){e.classList.toggle("hidden")}),this.elements.formField.appendChild(e)}}},{key:"validate",value:function(){var t=this.elements.input.value,e=this.validation&&!new RegExp(this.validation,"gi").test(t);return this.valid=!e,this.classList.toggle("invalid",e),this.valid}},{key:"addFocusAndBlurEvents",value:function(e){var n=this;e.addEventListener("focus",function(t){n.classList.add("focused"),n.publish("sasInputFocused",t.target)}),e.addEventListener("blur",function(t){n.validate(),e.value||n.classList.remove("focused")})}},{key:"value",get:function(){return this.elements.input.value}},{key:"label",get:function(){return this.getAttribute("label")}},{key:"name",get:function(){return this.getAttribute("name")}},{key:"id",get:function(){return this.getAttribute("id")}},{key:"type",get:function(){return this.getAttribute("type")}},{key:"validation",get:function(){return this.getAttribute("validation")}},{key:"message",get:function(){return this.getAttribute("message")}},{key:"mandatory",get:function(){return this.getAttribute("mandatory")}},{key:"options",set:function(t){this.setAttribute("options",JSON.stringify(t))},get:function(){return JSON.parse(this.getAttribute("options"))}},{key:"doValidation",get:function(){return this.validate}},{key:"infoText",get:function(){return this.getAttribute("infoText")}}]),e}();!function(t,i,e){var n=function(){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))}return _inherits(t,S4SInputBase),_createClass(t,[{key:"connectedCallback",value:function(){this.init(e.templates.formField),this.prepare(),this.addElements(),this.render(),this.valid=!1}},{key:"addElements",value:function(){this.createInput(),this.elements.formField.appendChild(this.elements.input),this.elements.formField.setAttribute("for",this.elements.input.id),this.elements.message.innerText=this.message,this.elements.label.innerText=this.label,this.createTooltip()}},{key:"createInput",value:function(){var t;-1<["select","textarea"].indexOf(this.type)?t=i.createElement(this.type):(t=i.createElement("input")).type=this.type,t.name=this.name,t.id=this.id||"".concat(this.name.replace(/[^a-z]/gi,"")).concat(Math.floor(1e3*Math.random())),t.setAttribute("data-validation",this.validation),this.addFocusAndBlurEvents(t),this.elements.input=t}},{key:"attributeChangedCallback",value:function(){this.render()}},{key:"render",value:function(){if(this.connected&&"select"===this.type&&this.options){this.elements.input.innerHTML="";for(var t=0;t<this.options.items.length;t++){var e=this.options.items[t],n=i.createElement("option");n.value=e.value,n.text=e.text,this.elements.input.appendChild(n)}}}}],[{key:"observedAttributes",get:function(){return["options"]}}]),t}();t.customElements.define("s4s-input",n)}(window,document,window.s4s),function(t,r){var e=function(){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))}return _inherits(t,_wrapNativeSuper(HTMLElement)),_createClass(t,[{key:"connectedCallback",value:function(){var t="http://www.w3.org/2000/svg",e=r.createElementNS(t,"svg"),n=r.createElementNS(t,"use"),i=this.getAttribute("name"),s=this.getAttribute("additionalClass");s&&e.classList.add(s),e.classList.add("sas-icon","sas-icon-"+i),n.setAttribute("xlink:href","#"+i),n.setAttribute("href","#"+i),e.appendChild(n);var a=this.getAttribute("text");if(a){e.setAttribute("role","icon");var o=r.createElement("title");o.innerText=a,e.appendChild(o)}else e.setAttribute("role","presentation");this.appendChild(e),this.iconName=i,this.icon=e,this.path=n,this.iconText=a}}]),t}();t.customElements.define("s4s-icon",e)}(window,document),function(n,i){var t=function(){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))}return _inherits(t,S4SBase),_createClass(t,[{key:"connectedCallback",value:function(){var e=this;this.init(i.templates.modal),this.elements.close.addEventListener("click",function(t){return e.setAttribute("hidden",!0)}),this.getAttribute("heading")?this.elements.heading.innerText=this.getAttribute("heading"):this.elements.heading.parentNode.removeChild(this.elements.heading),n.addEventListener("modalVisibility",function(t){t.detail.id===e.getAttribute("modal-id")&&e.toggleAttribute("hidden",!t.detail.visible)})}}]),t}();n.customElements.define("s4s-modal",t)}(window,(document,window.s4s)),function(t,n){var e=function(){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))}return _inherits(t,S4SBase),_createClass(t,[{key:"connectedCallback",value:function(){var e=this;this.init(n.templates.accordion),this.calculateContent(),this.expanded=!1,this.elements.button.addEventListener("click",function(t){return e.toggleMe(t)})}},{key:"calculateContent",value:function(){this.togglerHeight=this.elements.toggler.clientHeight+2,this.contentHeight=this.elements.content.clientHeight,this.elements.accordion.style.height="".concat(this.togglerHeight,"px"),this.elements.accordion.style.opacity=1}},{key:"toggleMe",value:function(t,e){this.expanded=void 0===e?!this.expanded:e,this.elements.accordion.style.height=this.expanded?"".concat(this.togglerHeight+this.contentHeight,"px"):"".concat(this.togglerHeight,"px"),this.elements.button.setAttribute("aria-expanded",this.expanded)}},{key:"toggle",set:function(t){this.toggleMe({},t)}}]),t}();t.customElements.define("s4s-accordion",e)}(window,(document,window.s4s));var S4SLoginBase=function(){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))}return _inherits(t,S4SBase),_createClass(t,[{key:"createElement",value:function(t,e){var n=e.classes,i=e.innerText,s=e.innerHTML,a=e.attributes,o=document.createElement(t);if(s?o.innerHTML=s:i&&(o.innerText=i),n&&n.forEach(function(t){o.classList.add(t)}),a)for(var r in a)o.setAttribute(r,a[r]);return o}},{key:"appendChildren",value:function(e,t){return t.forEach(function(t){t&&e.appendChild(t)})}}]),t}(),S4SLoginCreate=function(){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))}return _inherits(t,S4SLoginBase),_createClass(t,[{key:"addLoginElements",value:function(){var t=this.createElement("div",{classes:["s4s-login"]}),e=[this.createElement("h1",{classes:["h2"],innerText:this.content.login.heading}),this.createForm(),document.createElement("hr"),this.createForgotPassword(),this.createElement("h2",{classes:["h3"],innerText:this.content.login.subHeading}),this.createButtonRegister(),this.createForgotPasswordModal(),this.createRegisterModal()];this.appendChildren(t,e),this.appendChild(t),this.setAttribute("hidden",!0),this.wrapper=t}},{key:"createForm",value:function(){var n=this,i=document.createElement("form");i.addEventListener("submit",function(t){t.preventDefault(),0===Array.from(i.querySelectorAll("s4s-input")).filter(function(t){return!t.doValidation()}).length&&n.httpRequest("s4s-components/get-profile",{method:"POST"},function(t){var e=t.status;if(200===e)return t.json().then(function(t){n.publish("getProfileDone",{status:e,data:t})});n.publish("getProfileDone",{status:e})})});var t=this.createElement("p",{classes:["text-right"],innerText:this.content.login.requiredText});i.appendChild(t),this.content.login.inputFields.forEach(function(t){var e=n.createInput(t);i.appendChild(e)});var e=this.createElement("button",{innerText:this.content.login.submitLabel,classes:["block-element"]});return i.appendChild(e),i}},{key:"createForgotPassword",value:function(){var e=this,t=this.createElement("button",{innerText:this.content.login.passwordReset.text,classes:["reset","btn-link"]});return t.addEventListener("click",function(t){return e.publish("modalVisibility",{visible:!0,id:e.content.login.modals.forgotPassword.id})}),t}},{key:"createInput",value:function(t){var e=this.createElement("s4s-input",{classes:["block-element"]});for(var n in t)e.setAttribute(n,t[n]);return e}},{key:"createButtonRegister",value:function(){var e=this,t=this.createElement("button",{innerText:this.content.login.buttonLabel,classes:["block-element","btn-secondary"]});return t.addEventListener("click",function(t){return e.publish("modalVisibility",{visible:!0,id:e.content.login.modals.register.id})}),t}},{key:"createForgotPasswordModal",value:function(){var t=this.content.login.modals.forgotPassword,e=document.createElement("s4s-modal");return e.setAttribute("modal-id",t.id),e.setAttribute("hidden",!0),e.innerHTML="\n    <h1 class=".concat(t.heading.class,">").concat(t.heading.text,"</h1>\n    <h2 class=").concat(t.subheading.class,">").concat(t.subheading.text,"</h2>\n    <form\n    class=").concat(t.form.class,"\n    >\n    <s4s-input \n      class= ").concat(t.form.input.class,"\n      label=").concat(t.form.input.label," \n      name=").concat(t.form.input.name," \n      type=").concat(t.form.input.type," \n      message=").concat(t.form.input.message,"\n      validation=").concat(t.form.input.validation,"\n    >\n    </s4s-input>\n    <button \n      type=").concat(t.form.submit.type,"\n      class=").concat(t.form.submit.class,"\n    >\n      ").concat(t.form.submit.text,"\n    </button>\n    <form>\n    "),e}},{key:"createRegisterModal",value:function(){var t=this.content.login.modals.register,e=document.createElement("s4s-modal");return e.setAttribute("modal-id",t.id),e.setAttribute("hidden",!0),e.innerHTML="\n    <h1 class=".concat(t.heading.class,">").concat(t.heading.text,"</h1>\n    <form\n    class=").concat(t.form.class,"\n    >\n    <s4s-input \n      class= ").concat(t.form.input.class,"\n      label=").concat(t.form.input.label," \n      name=").concat(t.form.input.name," \n      type=").concat(t.form.input.type," \n      message=").concat(t.form.input.message,"\n      validation=").concat(t.form.input.validation,"\n    >\n    </s4s-input>\n    <button \n      type=").concat(t.form.submit.type,"\n      class=").concat(t.form.submit.class,"\n    >\n      ").concat(t.form.submit.text,"\n    </button>\n    <form>\n    "),e}}]),t}(),S4SLoggedInBusiness=function(){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))}return _inherits(t,S4SLoginCreate),_createClass(t,[{key:"createBusinessState",value:function(){this.businessState=document.createElement("div");var t=this.createColoredHeading(),e=[];this.isTravelAdmin()&&(e=[this.createTag("admin","Admin")]);var n=this.addCorporateInfo(),i=this.createTravelPass(),s=this.createLink(this.content.loggedIn.settings),a=this.createLink(this.content.loggedIn.logOut);this.appendChildren(this.businessState,[t].concat(_toConsumableArray(e),_toConsumableArray(n),[s,i,a]))}},{key:"addCorporateInfo",value:function(){return[document.createElement("hr"),this.createLink(this.content.loggedIn.companyDetails),this.createLink(this.content.loggedIn.travelers)]}},{key:"isTravelAdmin",value:function(){return!!this.data.corporateMemberEngagement.corporateMember[0].isTravelAdmin}}]),t}(),S4SLoggedInEurobonus=function(){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))}return _inherits(t,S4SLoggedInBusiness),_createClass(t,[{key:"addEurobonusInfo",value:function(){var t=[this.createTag(this.data.euroBonus.currentTierCode,this.data.euroBonus.currentTierName)];this.data.euroBonus.lifeTimeGold&&t.push(this.createTag("G","Lifetime Gold"));var e=this.addPrivateInfo(),n=this.createTravelPass(this.data.engagements.travelPass);this.appendChildren(this.privateState,[].concat(t,_toConsumableArray(e),[n]))}},{key:"addPrivateInfo",value:function(){return[this.createEurobonusinfo(),this.createLink(this.content.loggedIn.eurobonus)]}},{key:"createEurobonusinfo",value:function(){var t=this.createElement("div",{classes:["info-block"]}),e=this.createElement("h2",{classes:["h4"],innerText:this.content.loggedIn.eurobonusPoints}),n=this.createElement("h2",{classes:["h4"],innerText:this.content.loggedIn.expiringPoints}),i=this.createElement("p",{innerText:spaceAtThousand(this.data.euroBonus.totalPointsForUse)}),s=this.createEurobonusExpire();return this.appendChildren(t,[e,i,n,s]),t}},{key:"createEurobonusExpire",value:function(){var t=this.findSoonestToBeExpired(this.data.euroBonus.awardPointsExpiry),e=document.createElement("template");return e.innerHTML="<p>".concat(spaceAtThousand(t.points)," (<span>").concat(t.formattedDate,"</span>)</p>"),this.expiresInAMonth(t.expiryDate)&&e.content.querySelector("span").classList.add("color-r"),document.importNode(e.content,!0)}},{key:"findSoonestToBeExpired",value:function(t){return t.reduce(function(t,e){return Date.parse(e.expiryDate)<Date.parse(t.expiryDate)?e:t},t[0])}},{key:"expiresInAMonth",value:function(t){return Date.parse(t)-Date.now()<=2592e6}}]),t}(),S4SLoggedInPrivate=function(){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))}return _inherits(t,S4SLoggedInEurobonus),_createClass(t,[{key:"createPrivateState",value:function(){this.privateState=document.createElement("div");var t=this.createColoredHeading(this.data);this.privateState.appendChild(t),this.isEurobonusMember()&&this.addEurobonusInfo();var e=this.createLink(this.content.loggedIn.settings),n=this.createLink(this.content.loggedIn.logOut);this.appendChildren(this.privateState,[e,n])}}]),t}(),switcherIcon='<s4s-icon name="cl--swap" additionalClass="right"></s4s-icon>',Accordion=function(){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))}return _inherits(t,S4SLoggedInPrivate),_createClass(t,[{key:"createAccordion",value:function(){this.accordion=this.createElement("s4s-accordion",{attributes:{label:this.content.loggedIn.states.private.label},innerHTML:'<a href="/" element="switcher">'.concat(switcherIcon).concat(this.content.loggedIn.states.business.label,"</a>")})}},{key:"switchState",value:function(){this.hideAndShowState(),this.switchAccordionLabels(),this.accordion.toggle=!1}},{key:"hideAndShowState",value:function(){var t=this.accordion.elements.switcher.innerText.toLowerCase();t===this.content.loggedIn.states.business.label.toLowerCase()&&(this.privateState.setAttribute("hidden",!0),this.businessState.removeAttribute("hidden")),t===this.content.loggedIn.states.private.label.toLowerCase()&&(this.privateState.removeAttribute("hidden"),this.businessState.setAttribute("hidden",!0))}},{key:"switchAccordionLabels",value:function(){var t=this.accordion.elements.switcher.innerText;this.accordion.elements.switcher.innerHTML="".concat(switcherIcon).concat(this.accordion.elements.label.innerText.toLowerCase().replace("sas","SAS")),this.accordion.elements.label.innerText=t}}]),t}(),S4SLoggedInCreate=function(){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))}return _inherits(t,Accordion),_createClass(t,[{key:"addLoggedInElements",value:function(t){var e=this;this.data=t,this.states=this.content.loggedIn.states,this.wrapper.hidden=!0;var n=this.createElement("div",{classes:["s4s-login"]});this.appendChild(n),this.isSASForBusinessMember()&&(this.createAccordion(),n.appendChild(this.accordion),this.accordion.elements.switcher.addEventListener("click",function(t){t.preventDefault(),e.publish("LoginTogglerClicked",e.accordion.elements.switcher.innerHTML),e.switchState()})),this.createPrivateState(t),n.appendChild(this.privateState),this.isSASForBusinessMember()&&(this.createBusinessState(t),n.appendChild(this.businessState),this.businessState.setAttribute("hidden",!0))}},{key:"createTravelPass",value:function(){if((this.data.engagements||{}).travelPass){var t=this.createLink(this.content.loggedIn.travelPass),e=document.createElement("s4s-icon");return e.setAttribute("name","cl--new-window"),t.appendChild(e),t}}},{key:"createColoredHeading",value:function(){var t=document.createElement("template"),e=this.isEurobonusMember()?this.data.euroBonus.currentTierCode.toLowerCase():"b";return t.innerHTML='<h1 class="h2"> <span class="'.concat("greeting greeting-".concat(e),'">',this.content.loggedIn.greeting[this.getRandomInteger(0,7)],"</span> ").concat(this.data.individual.firstName,"!</h1>"),document.importNode(t.content,!0)}},{key:"getRandomInteger",value:function(t,e){return Math.floor(Math.random()*e)+t}},{key:"createLink",value:function(t){var e=t.text,n=t.href,i=t.className,s=document.createElement("p"),a=this.createElement("a",{classes:[i],innerText:e,attributes:{href:n}});return s.appendChild(a),s}},{key:"createTag",value:function(t,e){return this.createElement("div",{classes:["tag","tag-"+t.toLowerCase()],innerText:e})}},{key:"isSASForBusinessMember",value:function(){return!!this.data.corporateMemberEngagement}},{key:"isEurobonusMember",value:function(){return!!(this.data.engagements||{}).euroBonus}}]),t}(),spaceAtThousand=function(t){return t.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1 ")};!function(n,i){var s,t=function(){function e(){var t;return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this))).content=s,t.httpRequest=o,t}return _inherits(e,S4SLoggedInCreate),_createClass(e,[{key:"connectedCallback",value:function(){this.addLoginElements()}}]),e}(),a=/(www|test)\.(fly)?sas\.(com|se|no|dk|fi)/gi.test(location.hostname),o=function(t,e,n){var i=a?"/v2/de-design-library/".concat(t):"/".concat(t);fetch(i,e).then(n)};n.addEventListener("getProfileDone",function(t){200==t.detail.status&&i.querySelector("s4s-login").addLoggedInElements(t.detail.data)}),i.querySelectorAll(".s4s-login-opener").forEach(function(t){t.addEventListener("click",function(){n.dispatchEvent(new CustomEvent("loginOpenerClicked",{}))})}),n.addEventListener("contentLoaded",function(){n.customElements.define("s4s-login",t);var e=i.querySelector("s4s-login");e.toggleAttribute("hidden"),e.addEventListener("click",function(t){t.target===e&&e.setAttribute("hidden",!0)})}),n.addEventListener("loginOpenerClicked",function(){s?i.querySelector("s4s-login").removeAttribute("hidden"):o("s4s-components/content.json",{},function(t){return t.json().then(function(t){s=t,n.dispatchEvent(new CustomEvent("contentLoaded"))})})})}(window,document);